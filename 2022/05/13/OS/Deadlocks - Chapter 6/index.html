<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Deadlocks - Chapter 6 | Childish Chen's Blog</title><meta name="keywords" content="学习笔记,操作系统课程"><meta name="author" content="Childish Chen"><meta name="copyright" content="Childish Chen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Deadlocks - Chapter 6ResourceDeadlocks occur when processes are granted exclusive access to devices. We refer to these devices generally as resources. 具有排他性（某个时刻仅供一个进程使用）的对象称为Resource。 In short, a res">
<meta property="og:type" content="article">
<meta property="og:title" content="Deadlocks - Chapter 6">
<meta property="og:url" content="http://inblaze.github.io/2022/05/13/OS/Deadlocks%20-%20Chapter%206/index.html">
<meta property="og:site_name" content="Childish Chen&#39;s Blog">
<meta property="og:description" content="Deadlocks - Chapter 6ResourceDeadlocks occur when processes are granted exclusive access to devices. We refer to these devices generally as resources. 具有排他性（某个时刻仅供一个进程使用）的对象称为Resource。 In short, a res">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-05-13T12:22:00.000Z">
<meta property="article:modified_time" content="2022-05-13T12:27:27.423Z">
<meta property="article:author" content="Childish Chen">
<meta property="article:tag" content="学习笔记">
<meta property="article:tag" content="操作系统课程">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://inblaze.github.io/2022/05/13/OS/Deadlocks%20-%20Chapter%206/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Deadlocks - Chapter 6',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-05-13 20:27:27'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s4.ax1x.com/2022/03/03/bYXlxH.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archive</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Childish Chen's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archive</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Links</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Deadlocks - Chapter 6</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2022-05-13T12:22:00.000Z" title="Created 2022-05-13 20:22:00">2022-05-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2022-05-13T12:27:27.423Z" title="Updated 2022-05-13 20:27:27">2022-05-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E7%A8%8B%EF%BC%9A%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/">课程：操作系统</a></span></div><div class="meta-secondline"></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="Deadlocks-Chapter-6"><a href="#Deadlocks-Chapter-6" class="headerlink" title="Deadlocks - Chapter 6"></a>Deadlocks - Chapter 6</h1><h2 id="Resource"><a href="#Resource" class="headerlink" title="Resource"></a>Resource</h2><p>Deadlocks occur when processes are granted exclusive access to devices. We refer to these devices generally as <strong>resources</strong>.</p>
<p>具有<strong>排他性</strong>（某个时刻仅供一个进程使用）的对象称为<strong>Resource</strong>。</p>
<p>In short, a resource is anything that must <strong>be acquired</strong>, <strong>used</strong>, and <strong>released</strong> over the course of time.</p>
<p>The abstract sequence of events required to use a resource is given below.</p>
<ol>
<li><strong>Request</strong> the resource</li>
<li><strong>Use</strong> the resource</li>
<li><strong>Release</strong> the resource</li>
</ol>
<p>If request denied, process may <strong>be blocked</strong> (wait to be awaken) or <strong>fail with error code</strong> (determined by user). </p>
<h3 id="Preemptable-and-Nonpreemptable-Resources"><a href="#Preemptable-and-Nonpreemptable-Resources" class="headerlink" title="Preemptable and Nonpreemptable Resources"></a>Preemptable and Nonpreemptable Resources</h3><p>Resources come in 2 types: preemptable and nonpreemptable resources.</p>
<h4 id="Preemptable-Resource"><a href="#Preemptable-Resource" class="headerlink" title="Preemptable Resource"></a>Preemptable Resource</h4><p>Preemptable resources can be taken away with no ill effects, such as memory.</p>
<h4 id="Nonpreemptable-Resource"><a href="#Nonpreemptable-Resource" class="headerlink" title="Nonpreemptable Resource"></a>Nonpreemptable Resource</h4><p>Nonpreemptable resource cannot be taken away from its current owner without potentially causing failure, such as blue-ray recorder.</p>
<p><em>Whether a resource is preemptible depends on the context.</em></p>
<p>Deadlocks only involve <strong>nonpreemptable resource</strong>.</p>
<h2 id="Definition"><a href="#Definition" class="headerlink" title="Definition"></a>Definition</h2><p>A set of processes is deadlocked if each process in the set is waiting for an event that only another process in the set can cause.</p>
<p>如果一个进程集合中的每个进程都在等待只能由该进程集合中的其他进程才能引发的事件，那么，该进程集合就是<strong>死锁</strong>的。</p>
<h3 id="Conditions-for-Resource-Deadlocks"><a href="#Conditions-for-Resource-Deadlocks" class="headerlink" title="Conditions for Resource Deadlocks"></a>Conditions for Resource Deadlocks</h3><ol>
<li><strong>Mutual Exclusion Condition</strong>: Each resource is either currently assigned to exactly one process or is available.</li>
<li><strong>Hold-and-wait Condition</strong>: Process currently holding resources that were granted earlier can request new resources.</li>
<li><strong>No-preemption Condition</strong>: Resources previously granted cannot be forcibly taken away from a process. They must be explicitly released by the process holding them.</li>
<li><strong>Circular Wait Condition</strong>: There must be a circular list of two or more processes, each of which is waiting for a resource held by the next member of the chain.</li>
</ol>
<p>PS: 如发生Deadlock，四个条件缺一不可</p>
<h3 id="Deadlock-Modeling"><a href="#Deadlock-Modeling" class="headerlink" title="Deadlock Modeling"></a>Deadlock Modeling</h3><p><img src="https://s1.ax1x.com/2022/05/04/OEjfrq.png" alt="deadlockModel"></p>
<p><strong>Processes</strong>, shown as <strong>circles</strong>, and <strong>resources</strong>, shown as <strong>squares</strong>.</p>
<ul>
<li><p>A directed arc from a resource node (square) to a process node (circle) means that the resource has previously been requested by, granted to, and is currently held by that process.</p>
</li>
<li><p>A directed arc from a process to a resource means that the process is currently blocked waiting for that resource.</p>
</li>
<li>If this graph contains one or more cycles, a deadlock exists.</li>
</ul>
<h2 id="Dealing-with-Deadlocks"><a href="#Dealing-with-Deadlocks" class="headerlink" title="Dealing with Deadlocks"></a>Dealing with Deadlocks</h2><h3 id="Strategies-for-Dealing-with-Deadlocks"><a href="#Strategies-for-Dealing-with-Deadlocks" class="headerlink" title="Strategies for Dealing with Deadlocks"></a>Strategies for Dealing with Deadlocks</h3><ul>
<li>Just ignore the problem altogether</li>
<li>Detection and recovery</li>
<li>Dynamic avoidance - careful resource allocation</li>
<li>Prevention - negating one of the four conditions</li>
</ul>
<h3 id="The-Ostrich-Algorithm"><a href="#The-Ostrich-Algorithm" class="headerlink" title="The Ostrich Algorithm"></a>The Ostrich Algorithm</h3><ul>
<li>Pretend there is no problem</li>
<li>Reasonable if: <ul>
<li>deadlocks occur very rarely</li>
<li>cost of prevention is high</li>
</ul>
</li>
</ul>
<p>Unix and Windows takes this approach. It is a trade off between convenience correctness.</p>
<h3 id="Deadlock-Detection-and-Recovery"><a href="#Deadlock-Detection-and-Recovery" class="headerlink" title="Deadlock Detection and Recovery"></a>Deadlock Detection and Recovery</h3><p>系统并不会防范死锁的产生, 而是在死锁发生之后再进行死锁的检测与恢复.</p>
<h4 id="Deadlock-Detection-with-One-Resource-of-Each-Type"><a href="#Deadlock-Detection-with-One-Resource-of-Each-Type" class="headerlink" title="Deadlock Detection with One Resource of Each Type"></a>Deadlock Detection with One Resource of Each Type</h4><ul>
<li>在图中<strong>DFS判环</strong>即可</li>
</ul>
<h4 id="Deadlock-Detection-with-Multiple-Resources-of-Each-Type"><a href="#Deadlock-Detection-with-Multiple-Resources-of-Each-Type" class="headerlink" title="Deadlock Detection with Multiple Resources of Each Type"></a>Deadlock Detection with Multiple Resources of Each Type</h4><p><a target="_blank" rel="noopener" href="https://imgtu.com/i/OV82rj"><img src="https://s1.ax1x.com/2022/05/04/OV82rj.md.png" alt="OV82rj.md.png"></a></p>
<ul>
<li>E: existing resource vector</li>
<li>A: available resource vector</li>
<li>C: current allocation matrix</li>
<li>R: request matrix</li>
</ul>
<script type="math/tex; mode=display">
\sum_{i=1}^{n}C_{ij}+A_j=E_j</script><p>The deadlock detection algorithm can now be giv en as follows.</p>
<ol>
<li>Look for an unmarked process, P i , for which the ith row of R is less than or equal to A.</li>
<li>If such a process is found, add the ith row of C to A, mark the process, and go back to step 1.</li>
<li>If no such process exists, the algorithm terminates.</li>
</ol>
<p>When the algorithm finishes, all the unmarked processes, if any, are deadlocked. There’s no deadlock if there’s no unmarked process.</p>
<h4 id="Recovery-from-Deadlock"><a href="#Recovery-from-Deadlock" class="headerlink" title="Recovery from Deadlock"></a>Recovery from Deadlock</h4><ul>
<li><p><strong>Recovery through Preemption</strong></p>
<p>Take a resource away from its current owner and give it to another process. It depends on the nature of the resource.</p>
</li>
<li><p><strong>Recovery through Rollback</strong></p>
<p><strong>checkpoint</strong> a process periodically to save the state of the process. Restart the process if found deadlocked by using the saved state.</p>
</li>
<li><p><strong>Recovery through Killing Processes</strong></p>
<p>Kill a process in the cycle. With a little luck, the other processes will be able to continue. If this does not help, it can be repeated until the cycle is broken.</p>
<p>Where possible, it is best to kill a process that can be rerun from the beginning with no ill effects.</p>
<p>Alternatively, a process not in the cycle can be chosen as the victim in order to release its resources.</p>
</li>
</ul>
<h3 id="Deadlock-Avoidance"><a href="#Deadlock-Avoidance" class="headerlink" title="Deadlock Avoidance"></a>Deadlock Avoidance</h3><h4 id="Resource-Trajectories"><a href="#Resource-Trajectories" class="headerlink" title="Resource Trajectories"></a>Resource Trajectories</h4><p><a target="_blank" rel="noopener" href="https://imgtu.com/i/O8WC6J"><img src="https://s1.ax1x.com/2022/05/09/O8WC6J.md.png" alt="O8WC6J.md.png"></a></p>
<ul>
<li>横轴表示Process A的运行阶段，纵轴表示Process B的运行阶段</li>
<li>Process A、B占用Printer的重合时间段将会被标上从左下到右上的斜线，Process A、B占用Plotter的重合时间段将会被标上从左上到右下的斜线</li>
<li>虚线表示系统调度Process A、B运行的过程，该过程不可回退，只能向右或者向上</li>
<li>当Process A穿过$I_1$线时，它请求获得Printer，同理，当Process B到达t时，它请求Plotter</li>
</ul>
<h4 id="Safe-and-Unsafe-States"><a href="#Safe-and-Unsafe-States" class="headerlink" title="Safe and Unsafe States"></a>Safe and Unsafe States</h4><p>A state is said to be <strong>safe</strong> if there is some scheduling order in which every process can run to completion even if all of them suddenly request their maximum number of resources immediately.</p>
<p><strong>Safe State</strong>:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/O8T95n"><img src="https://s1.ax1x.com/2022/05/09/O8T95n.md.png" alt="O8T95n.md.png"></a></p>
<p><strong>Unsafe State</strong>:</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/O8TEKU"><img src="https://s1.ax1x.com/2022/05/09/O8TEKU.md.png" alt="O8TEKU.md.png"></a></p>
<h4 id="Banker’s-Algorithm"><a href="#Banker’s-Algorithm" class="headerlink" title="Banker’s Algorithm"></a>Banker’s Algorithm</h4><p>The banker’s algorithm considers each request as it occurs, seeing whether granting it leads to a safe state. If it does, the request is granted; otherwise, it is postponed until later. To see if a state is safe, the banker checks to see if he has enough resources to satisfy some customer. If so, those loans are assumed to be repaid, and the customer now closest to the limit is checked, and so on. If all loans can eventually be repaid, the state is safe and the initial request can be granted.</p>
<p><a target="_blank" rel="noopener" href="https://imgtu.com/i/OGpCmn"><img src="https://s1.ax1x.com/2022/05/09/OGpCmn.md.png" alt="OGpCmn.md.png"></a></p>
<p>The algorithm for checking to see if a state is safe can now be stated.</p>
<ol>
<li>Look for a row, R, whose unmet resource needs are all smaller than or equal to A. If no such row exists, the system will eventually deadlock since no process can run to completion (assuming processes keep all resources until they exit).</li>
<li>Assume the process of the chosen row requests all the resources it needs (which is guaranteed to be possible) and finishes. Mark that process as terminated and add all of its resources to the A vector.</li>
<li>Repeat steps 1 and 2 until either all processes are marked terminated (in which case the initial state was safe) or no process is left whose resource needs can be met (in which case the system was not safe).</li>
</ol>
<h3 id="Deadlock-Prevention"><a href="#Deadlock-Prevention" class="headerlink" title="Deadlock Prevention"></a>Deadlock Prevention</h3><h4 id="Attacking-the-Mutual-Exclusion-Condition"><a href="#Attacking-the-Mutual-Exclusion-Condition" class="headerlink" title="Attacking the Mutual-Exclusion Condition"></a>Attacking the Mutual-Exclusion Condition</h4><ul>
<li>By <strong>spooling</strong> printer output, several processes can generate output at the same time. In this model, the only process that actually requests the physical printer is the printer daemon. Since the daemon never requests any other resources, we can eliminate deadlock for the printer.</li>
</ul>
<p>Nevertheless, there is a germ of an idea here that is frequently applicable. <strong>Avoid assigning a resource unless absolutely necessary</strong>, and try to make sure that <strong>as few processes as possible may actually claim the resource</strong>.</p>
<h4 id="Attacking-the-Hold-and-Wait-Condition"><a href="#Attacking-the-Hold-and-Wait-Condition" class="headerlink" title="Attacking the Hold-and-Wait Condition"></a>Attacking the Hold-and-Wait Condition</h4><ul>
<li>Require <strong>all processes to request all their resources before starting execution</strong>. If everything is available, the process will be allocated whatever it needs and can run to completion. If one or more resources are busy, nothing will be allocated and the process will just wait.</li>
<li>Require <strong>a process requesting a resource to first temporarily release all the resources it currently holds. Then it tries to get everything it needs all at once</strong>.</li>
</ul>
<h4 id="Attacking-the-No-Preemption-Condition"><a href="#Attacking-the-No-Preemption-Condition" class="headerlink" title="Attacking the No-Preemption Condition"></a>Attacking the No-Preemption Condition</h4><ul>
<li>Some resources can be virtualized to avoid this situation.</li>
<li>消除了打印机的死锁也可能带来硬盘的死锁.</li>
<li>Not all resources can be virtualized.</li>
</ul>
<h4 id="Attacking-the-Circular-Wait-Condition"><a href="#Attacking-the-Circular-Wait-Condition" class="headerlink" title="Attacking the Circular Wait Condition"></a>Attacking the Circular Wait Condition</h4><ul>
<li>每次只允许占据一个资源</li>
<li>对所有资源进行编号, 某进程每次请求的资源不能是比自己占有的资源序号低的资源. 这样资源分配图中肯定不会出现环 (而是一条链).</li>
<li>上一种方式的变种：不允许进程请求比当前所占有资源最低编号低的资源</li>
</ul>
<h3 id="Other-Issues-Non-key"><a href="#Other-Issues-Non-key" class="headerlink" title="Other Issues (Non-key)"></a>Other Issues (Non-key)</h3><h4 id="Two-Phase-Locking"><a href="#Two-Phase-Locking" class="headerlink" title="Two-Phase Locking"></a>Two-Phase Locking</h4><ul>
<li>The first phase:  the process tries to lock all the records it needs, one at a time. </li>
<li>If during the first phase, some record is needed that is already locked, the process just releases all its locks and starts the first phase all over.</li>
<li>If it succeeds, it begins the second phase, performing its updates and releasing the locks.</li>
</ul>
<h4 id="Communication-Deadlocks"><a href="#Communication-Deadlocks" class="headerlink" title="Communication Deadlocks"></a>Communication Deadlocks</h4><h4 id="Livelock"><a href="#Livelock" class="headerlink" title="Livelock"></a>Livelock</h4><h4 id="Starvation"><a href="#Starvation" class="headerlink" title="Starvation"></a>Starvation</h4></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a><a class="post-meta__tags" href="/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%AF%BE%E7%A8%8B/">操作系统课程</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/29/OS/Memory%20Management%20-%20Chapter%203/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">Memory Management - Chapter 3</div></div></a></div><div class="next-post pull-right"><a href="/2022/04/30/ComputerArchitecture/%E6%8C%87%E4%BB%A4%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%20-%20Chapter%204/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">指令系统与汇编语言</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2022/04/16/OS/Process%20and%20Thread%20-%20Chapter%202/" title="Process and Thread - Chapter 2"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-04-16</div><div class="title">Process and Thread - Chapter 2</div></div></a></div><div><a href="/2022/05/29/OS/Memory%20Management%20-%20Chapter%203/" title="Memory Management - Chapter 3"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-29</div><div class="title">Memory Management - Chapter 3</div></div></a></div><div><a href="/2022/03/21/Vim/2022-03-21-Vimtutor%E7%AC%AC%E4%B8%89%E8%AE%B2/" title="Vimtutor第三讲"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-21</div><div class="title">Vimtutor第三讲</div></div></a></div><div><a href="/2022/03/19/Vim/Vimtutor%E7%AC%AC%E4%B8%80%E8%AE%B2/" title="Vimtutor第一讲"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-19</div><div class="title">Vimtutor第一讲</div></div></a></div><div><a href="/2022/03/20/Vim/Vimtutor%E7%AC%AC%E4%BA%8C%E8%AE%B2/" title="Vimtutor第二讲"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-20</div><div class="title">Vimtutor第二讲</div></div></a></div><div><a href="/2022/03/19/Vim/Why%20Vim/" title="Why Vim?"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-03-19</div><div class="title">Why Vim?</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NTYzNi8zMjEwMw=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s4.ax1x.com/2022/03/03/bYXlxH.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Childish Chen</div><div class="author-info__description">Every great story begins with a vision.</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">17</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">6</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">4</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/inblaze"><i class="fab fa-github"></i><span>My Github Account</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Deadlocks-Chapter-6"><span class="toc-number">1.</span> <span class="toc-text">Deadlocks - Chapter 6</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Resource"><span class="toc-number">1.1.</span> <span class="toc-text">Resource</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Preemptable-and-Nonpreemptable-Resources"><span class="toc-number">1.1.1.</span> <span class="toc-text">Preemptable and Nonpreemptable Resources</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Preemptable-Resource"><span class="toc-number">1.1.1.1.</span> <span class="toc-text">Preemptable Resource</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Nonpreemptable-Resource"><span class="toc-number">1.1.1.2.</span> <span class="toc-text">Nonpreemptable Resource</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Definition"><span class="toc-number">1.2.</span> <span class="toc-text">Definition</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Conditions-for-Resource-Deadlocks"><span class="toc-number">1.2.1.</span> <span class="toc-text">Conditions for Resource Deadlocks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deadlock-Modeling"><span class="toc-number">1.2.2.</span> <span class="toc-text">Deadlock Modeling</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Dealing-with-Deadlocks"><span class="toc-number">1.3.</span> <span class="toc-text">Dealing with Deadlocks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Strategies-for-Dealing-with-Deadlocks"><span class="toc-number">1.3.1.</span> <span class="toc-text">Strategies for Dealing with Deadlocks</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#The-Ostrich-Algorithm"><span class="toc-number">1.3.2.</span> <span class="toc-text">The Ostrich Algorithm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deadlock-Detection-and-Recovery"><span class="toc-number">1.3.3.</span> <span class="toc-text">Deadlock Detection and Recovery</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Deadlock-Detection-with-One-Resource-of-Each-Type"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">Deadlock Detection with One Resource of Each Type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Deadlock-Detection-with-Multiple-Resources-of-Each-Type"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">Deadlock Detection with Multiple Resources of Each Type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Recovery-from-Deadlock"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">Recovery from Deadlock</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deadlock-Avoidance"><span class="toc-number">1.3.4.</span> <span class="toc-text">Deadlock Avoidance</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Resource-Trajectories"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">Resource Trajectories</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Safe-and-Unsafe-States"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">Safe and Unsafe States</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Banker%E2%80%99s-Algorithm"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">Banker’s Algorithm</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Deadlock-Prevention"><span class="toc-number">1.3.5.</span> <span class="toc-text">Deadlock Prevention</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-the-Mutual-Exclusion-Condition"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">Attacking the Mutual-Exclusion Condition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-the-Hold-and-Wait-Condition"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">Attacking the Hold-and-Wait Condition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-the-No-Preemption-Condition"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">Attacking the No-Preemption Condition</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Attacking-the-Circular-Wait-Condition"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">Attacking the Circular Wait Condition</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Other-Issues-Non-key"><span class="toc-number">1.3.6.</span> <span class="toc-text">Other Issues (Non-key)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Two-Phase-Locking"><span class="toc-number">1.3.6.1.</span> <span class="toc-text">Two-Phase Locking</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Communication-Deadlocks"><span class="toc-number">1.3.6.2.</span> <span class="toc-text">Communication Deadlocks</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Livelock"><span class="toc-number">1.3.6.3.</span> <span class="toc-text">Livelock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Starvation"><span class="toc-number">1.3.6.4.</span> <span class="toc-text">Starvation</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/05/29/OS/Memory%20Management%20-%20Chapter%203/" title="Memory Management - Chapter 3"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Memory Management - Chapter 3"/></a><div class="content"><a class="title" href="/2022/05/29/OS/Memory%20Management%20-%20Chapter%203/" title="Memory Management - Chapter 3">Memory Management - Chapter 3</a><time datetime="2022-05-29T12:22:00.000Z" title="Created 2022-05-29 20:22:00">2022-05-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/13/OS/Deadlocks%20-%20Chapter%206/" title="Deadlocks - Chapter 6"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Deadlocks - Chapter 6"/></a><div class="content"><a class="title" href="/2022/05/13/OS/Deadlocks%20-%20Chapter%206/" title="Deadlocks - Chapter 6">Deadlocks - Chapter 6</a><time datetime="2022-05-13T12:22:00.000Z" title="Created 2022-05-13 20:22:00">2022-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/30/ComputerArchitecture/%E6%8C%87%E4%BB%A4%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%20-%20Chapter%204/" title="指令系统与汇编语言"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="指令系统与汇编语言"/></a><div class="content"><a class="title" href="/2022/04/30/ComputerArchitecture/%E6%8C%87%E4%BB%A4%E7%B3%BB%E7%BB%9F%E4%B8%8E%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%20-%20Chapter%204/" title="指令系统与汇编语言">指令系统与汇编语言</a><time datetime="2022-04-30T15:02:00.000Z" title="Created 2022-04-30 23:02:00">2022-04-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/16/OS/Process%20and%20Thread%20-%20Chapter%202/" title="Process and Thread - Chapter 2"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Process and Thread - Chapter 2"/></a><div class="content"><a class="title" href="/2022/04/16/OS/Process%20and%20Thread%20-%20Chapter%202/" title="Process and Thread - Chapter 2">Process and Thread - Chapter 2</a><time datetime="2022-04-16T12:22:00.000Z" title="Created 2022-04-16 20:22:00">2022-04-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/04/02/Vim/2022-04-2-Vimtutor%E7%AC%AC%E4%B8%83%E8%AE%B2/" title="Vimtutor第七讲"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Vimtutor第七讲"/></a><div class="content"><a class="title" href="/2022/04/02/Vim/2022-04-2-Vimtutor%E7%AC%AC%E4%B8%83%E8%AE%B2/" title="Vimtutor第七讲">Vimtutor第七讲</a><time datetime="2022-04-02T03:24:00.000Z" title="Created 2022-04-02 11:24:00">2022-04-02</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By Childish Chen</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadLivere () {
  if (typeof LivereTower === 'object') {
    window.LivereTower.init()
  }
  else {
    (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
    })(document, 'script');
  }
}

if ('Livere' === 'Livere' || !false) {
  if (false) btf.loadComment(document.getElementById('lv-container'), loadLivere)
  else loadLivere()
}
else {
  function loadOtherComment () {
    loadLivere()
  }
}</script></div></div></body></html>